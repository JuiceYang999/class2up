# 任务一到六遇到主要问题：

---

### 阶段一：VUE 前端启动与配置（“我的网页跑不起来”）

这是我们最早遇到的问题，我们当时的目标是先把 VUE 框架跑起来。

**问题 1：`'vue-cli-service' 不是内部或外部命令...`**
* **你遇到的现象：** 在终端里运行 `npm run serve`，直接报错。
* **背后的原因：**
    1.  你用了 `npm`，但项目文件里有 `yarn.lock`，说明它是个 `yarn` 项目。
    2.  你没有运行 `yarn install`，所以 `node_modules` 文件夹是空的，系统根本找不到 `vue-cli-service` 这个程序。
* **解决方案：** 严格按照 `README.md` 文件，先运行 `yarn install` 安装依赖，再运行 `yarn serve` 启动。

**问题 2：`Module not found: Error: Can't resolve 'element-ui', 'vue-router'` 等...**
* **你遇到的现象：** `yarn serve` 运行时，编译失败，报了一大堆“模块未找到”的错误。
* **背后的原因：** 我们在“任务一”里给 `main.js` 和 `router.js` 添加了 `import ElementUI` 和 `import VueRouter`，但是我们**只 `import`（引用）了**，却**没有真正把这些库“安装”到项目里**。
* **解决方案：** 运行 `yarn add vue-router@3 element-ui axios echarts`，把我们代码中用到的所有新依赖一次性全装上。

**问题 3：浏览器显示 `Proxy error: ... ECONNREFUSED`**
* **你遇到的现象：** VUE 页面能打开，但F12控制台（或终端）报“代理错误，连接被拒绝”。
* **背后的原因：** `ECONNREFUSED` = 连接被拒绝。你的 VUE 前端（`localhost:8080`）正在尝试访问 `vue.config.js` 里配置的后端地址（`http://127.0.0.1:5000`），但那个地址上**什么服务都没有**。
* **解决方案：** 启动我们的 **Python 后端服务**。这证明了前后端分离项目，必须**至少**运行两个终端：一个 `yarn serve` (前端)，一个 `python pyt/backend.py` (后端)。

---

### 阶段二：Python 后端与环境配置（“我的后端也跑不起来”）

**问题 4：`ModuleNotFoundError: No module named 'influxdb_client'`**
* **你遇到的现象：** `python pyt/backend.py` 启动失败，报“模块未找到”。
* **背后的原因：** 和 VUE 的问题一样，我们 `import influxdb_client` 了，但你的 Python 环境里没有安装它。
* **解决方案：** 运行 `pip install influxdb-client`（以及 Flask, pymysql 等所有我们需要的库）。

**问题 5：MySQL 报错 `1045 - Access denied for user 'root'`**
* **你遇到的现象：** 你用 Navicat 测试连接 MySQL 失败。
* **背后的原因：** 你在 Navicat 里填的密码，和你电脑上安装 MySQL 时设置的 `root` 密码**不一致**。
* **解决方案：** 在 `pyt/backend.py` 和 Navicat 中，都统一改成你**正确的** MySQL `root` 密码。

**问题 6：`'influxd' 不是内部或外部命令...`**
* **你遇到的现象：** 启动 InfluxDB 数据库服务时，系统找不到 `influxd`。
* **背后的原因：**
    1.  《实验步骤.pdf》里的路径 `E:\MQTT-test` 是老师电脑上的，你电脑上没有。
    2.  `influxd` 是一个**独立的服务程序**，和我们用 `pip` 装的 `influxdb-client`（库）是两回事。
    3.  你在 `cmd` 里从 C 盘切换到 D 盘时，命令没用对（你用了 `cd D:\...`，但正确姿势是先输 `D:` 再 `cd`）。
* **解决方案：**
    1.  从 InfluxDB 官网下载 `.zip` 包并解压（比如到 `D:\code9\class2down\influxd`）。
    2.  在 `cmd` 中先用 `D:` 切换盘符，再用 `cd D:\code9\class2down\influxd` 进入目录。
    3.  运行 `influxd` 启动服务。

---

### 阶段三：联调与“灵异事件”（“为什么它就是不工作？！”）

这是最“阴”的部分，也是我们刚刚才解决的！你所有的服务（5个终端）都跑起来了，但 VUE 页面就是没数据 ``。

**问题 7：“无限重启” Bug (来自 `image_2b1be4.png`)**
* **你遇到的现象：** Python 后端（终端5）不停地重复打印 `MQTT 连接成功` ``。
* **背后的原因：** 我们在 `pyt/backend.py` 的最后一行用了 `app.run(debug=True)`。
    * `debug=True` 会“监视”你项目里的所有文件，文件一改动，它就**自动重启**服务。
    * 我们的代码**恰好**会往项目里的 `pyt/hdfs_temp_data.csv` 文件**写数据**。
    * 这就导致：后端收到数据 -> 写入文件 -> 监视器发现文件被改 -> **立刻重启** -> 重启后打印 `MQTT 连接成功` `` -> 收到下一条数据... 如此循环。
* **解决方案：** 修改 `pyt/backend.py` 的最后一行，改成 `app.run(debug=True, use_reloader=False)`，**关掉**这个自动重启功能。

**问题 8：“图表没线” Bug (来自 `image_2b90d9.png`)**
* **你遇到的现象：** VUE 页面图表是空的 ``，F12 控制台显示 `数据ID ... 尚未收到` ``。
* **背后的原因（这个 Bug 有两个“元凶”）：**
    1.  **Python 端的元凶**：`debug=True` 导致后端无限重启（问题7），`latest_data_store` 变量刚存上数据（比如 `10.9526`）就被**清空**了。VUE 来取数据时，库里永远是空的，所以后端返回 `not_found`（“尚未收到”）。
    2.  **VUE 端的元凶**：（即使后端好了）`ShowData.vue` 里的 Echarts `setOption` 函数**忘记**加 `type: 'line'` 了。Echarts 拿到数据但不知道该画什么图，所以不画。
* **解决方案：**
    1.  解决“无限重启” Bug（问题7）。
    2.  在 `ShowData.vue` 里的 `setOption` 中**必须**加上 `type: 'line'` 和 `smooth: true`。

**问题 9：InfluxDB 数据库没有数据 (来自 `image_2b8cfc.png` 和 `image_2b909d.png`)**
* **你遇到的现象：** 本地和云端的 InfluxDB 都是 `No Results` ``，但后端日志却说 `InfluxDB 写入成功`。
* **背后的原因（这个 Bug 也有两个“元凶”）：**
    1.  **无限重启的元凶**（问题7）：后端日志打印 `写入成功` 只是代表它**调用了**写入函数，但还没等数据包真正通过网络发到数据库，服务就被**重启**了，所以数据库啥也没收到。
    2.  **Token 格式的元凶**：你 `backend.py` 里的**云端 Token** 多了 `INFLUXDB_TOKEN=` 字样，导致云端连接认证失败。
* **解决方案：**
    1.  解决“无限重启” Bug（问题7）。
    2.  **清理 Token**，把 `INFLUX_CLOUD_TOKEN = "INFLUXDB_TOKEN=zsOj..."` 改成 `INFLUX_CLOUD_TOKEN = "zsOj..."`。
